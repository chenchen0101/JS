# **同源策略&跨域请求**

[toc]





## 如何解决同源策略

### CORS(跨域资源共享)

CORS是由浏览器和服务端共同支持的一种协议。整个CORS通信过程，都由浏览器独自完成。对于CORS发来的简单请求，浏览器直接发出，并在其头信息中添加origin字段。服务器根据源信息（协议 + 域名 + 端口），返回是否通过的响应。

对于CORS发来的非简单请求。浏览器会在正式通信前发出预检请求（除了`Origin`字段，"预检"请求的头信息包括两个特殊字段：Access-Control-Request-Method、Access-Control-Request-Headers），询问服务器当前网站的域名是否在许可名单之内。若允许，浏览器才会发送正式请求。

### 什么是简单请求 & 非简单请求？

简单请求：

（1) 请求方法是以下三种方法之一：

- HEAD
- GET
- POST

（2）HTTP的头信息不超出以下几种基础字段：

- Accept
- Accept-Language
- Content-Language
- Last-Event-ID
- Content-Type：只限于三个值`application/x-www-form-urlencoded`、`multipart/form-data`、`text/plain`

### 非简单请求的“预检"请求是什么？

预检请求（除了`Origin`字段，"预检"请求的头信息包括两个特殊字段：Access-Control-Request-Method：服务器支持的所有跨域请求的方法、Access-Control-Request-Headers：服务器支持的所有头信息字段）

### JSONP

利用script标签src属性不受同源策略的影响，以访问不同服务下的资源。客户端定义好一个回调函数，在script标签里将其名通过某种方式传递给服务端，服务端接收回调函数的名字并返回回调函数的调用。